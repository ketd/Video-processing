{
  "schema_version": "1.0",
  "id": "video-processing-prefab",
  "version": "0.2.0",
  "name": "视频处理预制件",
  "description": "基于 MoviePy 的视频处理工具集，支持视频转音频、视频拼接、视频剪辑、调整大小等常见操作",
  "tags": [
    "video",
    "audio",
    "multimedia",
    "moviepy",
    "video-editing",
    "conversion"
  ],
  "entry_point": "src/main.py",
  "dependencies_file": "pyproject.toml",
  "functions": [
    {
      "name": "video_to_audio",
      "description": "将视频文件转换为音频文件，支持多种音频格式",
      "parameters": [
        {
          "name": "input_files",
          "type": "array",
          "items": {
            "type": "InputFile"
          },
          "minItems": 1,
          "maxItems": 1,
          "description": "输入视频文件（只需要1个）",
          "required": true
        },
        {
          "name": "audio_format",
          "type": "string",
          "description": "音频格式（mp3, wav, aac, flac 等），默认为 mp3",
          "required": false,
          "default": "mp3"
        },
        {
          "name": "audio_bitrate",
          "type": "string",
          "description": "音频比特率，默认为 192k",
          "required": false,
          "default": "192k"
        }
      ],
      "returns": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "是否成功"
          },
          "output_file": {
            "type": "OutputFile",
            "description": "输出音频文件路径（data/outputs/audio.{format}）"
          },
          "format": {
            "type": "string",
            "description": "音频格式"
          },
          "duration": {
            "type": "number",
            "description": "音频时长（秒）"
          },
          "error": {
            "type": "string",
            "description": "错误信息"
          },
          "error_code": {
            "type": "string",
            "description": "错误代码"
          }
        }
      }
    },
    {
      "name": "concatenate_videos",
      "description": "拼接多个视频文件",
      "parameters": [
        {
          "name": "input_files",
          "type": "array",
          "items": {
            "type": "InputFile"
          },
          "minItems": 2,
          "description": "输入视频文件列表（至少2个）",
          "required": true
        },
        {
          "name": "output_format",
          "type": "string",
          "description": "输出视频格式，默认 mp4",
          "required": false,
          "default": "mp4"
        },
        {
          "name": "method",
          "type": "string",
          "description": "拼接方法（compose 或 chain），默认 compose",
          "required": false,
          "default": "compose",
          "enum": ["compose", "chain"]
        }
      ],
      "returns": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "是否成功"
          },
          "output_file": {
            "type": "OutputFile",
            "description": "输出视频文件路径"
          },
          "input_count": {
            "type": "integer",
            "description": "输入文件数量"
          },
          "total_duration": {
            "type": "number",
            "description": "总时长（秒）"
          },
          "error": {
            "type": "string",
            "description": "错误信息"
          },
          "error_code": {
            "type": "string",
            "description": "错误代码"
          }
        }
      }
    },
    {
      "name": "trim_video",
      "description": "剪辑视频片段",
      "parameters": [
        {
          "name": "input_files",
          "type": "array",
          "items": {
            "type": "InputFile"
          },
          "minItems": 1,
          "maxItems": 1,
          "description": "输入视频文件（只需要1个）",
          "required": true
        },
        {
          "name": "start_time",
          "type": "number",
          "description": "开始时间（秒）",
          "required": true
        },
        {
          "name": "end_time",
          "type": "number",
          "description": "结束时间（秒），如果不提供则到视频结尾",
          "required": false
        },
        {
          "name": "output_format",
          "type": "string",
          "description": "输出格式，默认 mp4",
          "required": false,
          "default": "mp4"
        }
      ],
      "returns": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "是否成功"
          },
          "output_file": {
            "type": "OutputFile",
            "description": "输出视频文件路径"
          },
          "start_time": {
            "type": "number",
            "description": "实际开始时间"
          },
          "end_time": {
            "type": "number",
            "description": "实际结束时间"
          },
          "duration": {
            "type": "number",
            "description": "片段时长"
          },
          "error": {
            "type": "string",
            "description": "错误信息"
          },
          "error_code": {
            "type": "string",
            "description": "错误代码"
          }
        }
      }
    },
    {
      "name": "resize_video",
      "description": "调整视频尺寸",
      "parameters": [
        {
          "name": "input_files",
          "type": "array",
          "items": {
            "type": "InputFile"
          },
          "minItems": 1,
          "maxItems": 1,
          "description": "输入视频文件（只需要1个）",
          "required": true
        },
        {
          "name": "width",
          "type": "integer",
          "description": "目标宽度（像素），如果只提供宽度则按比例缩放",
          "required": false
        },
        {
          "name": "height",
          "type": "integer",
          "description": "目标高度（像素），如果只提供高度则按比例缩放",
          "required": false
        },
        {
          "name": "scale",
          "type": "number",
          "description": "缩放比例（如 0.5 表示缩小一半），优先级低于 width/height",
          "required": false
        },
        {
          "name": "output_format",
          "type": "string",
          "description": "输出格式，默认 mp4",
          "required": false,
          "default": "mp4"
        }
      ],
      "returns": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "是否成功"
          },
          "output_file": {
            "type": "OutputFile",
            "description": "输出视频文件路径"
          },
          "original_size": {
            "type": "array",
            "items": {
              "type": "integer"
            },
            "description": "原始尺寸 [width, height]"
          },
          "new_size": {
            "type": "array",
            "items": {
              "type": "integer"
            },
            "description": "新尺寸 [width, height]"
          },
          "error": {
            "type": "string",
            "description": "错误信息"
          },
          "error_code": {
            "type": "string",
            "description": "错误代码"
          }
        }
      }
    },
    {
      "name": "extract_frames",
      "description": "从视频提取帧",
      "parameters": [
        {
          "name": "input_files",
          "type": "array",
          "items": {
            "type": "InputFile"
          },
          "minItems": 1,
          "maxItems": 1,
          "description": "输入视频文件（只需要1个）",
          "required": true
        },
        {
          "name": "times",
          "type": "array",
          "items": {
            "type": "number"
          },
          "description": "要提取的时间点列表（秒）",
          "required": true
        },
        {
          "name": "output_format",
          "type": "string",
          "description": "输出图片格式，默认 jpg",
          "required": false,
          "default": "jpg"
        }
      ],
      "returns": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "是否成功"
          },
          "frame_count": {
            "type": "integer",
            "description": "提取的帧数"
          },
          "frames": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "帧文件路径列表"
          },
          "error": {
            "type": "string",
            "description": "错误信息"
          },
          "error_code": {
            "type": "string",
            "description": "错误代码"
          }
        }
      }
    }
  ]
}

